<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة التحكم - نبض التقنية</title>
    
    <!-- الخطوط -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- الأيقونات -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- الأنماط -->
    <link rel="stylesheet" href="style.css">
    
    <!-- أنماط الإدارة -->
    <style>
        :root {
            --admin-bg: #f5f7fa;
            --admin-sidebar: #1a237e;
            --admin-card: #ffffff;
            --admin-border: #e0e6ed;
            --admin-text: #3c4858;
            --admin-primary: #1a237e;
            --admin-success: #4caf50;
            --admin-warning: #ff9800;
            --admin-danger: #f44336;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: var(--admin-bg);
            color: var(--admin-text);
            direction: rtl;
            min-height: 100vh;
        }
        
        /* شاشة المصادقة */
        .auth-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #1a237e 0%, #311b92 100%);
            padding: 20px;
        }
        
        .auth-box {
            background: white;
            border-radius: 15px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            text-align: center;
        }
        
        .auth-logo {
            margin-bottom: 30px;
        }
        
        .auth-logo i {
            font-size: 3rem;
            color: var(--admin-primary);
            margin-bottom: 15px;
        }
        
        .auth-logo h1 {
            color: var(--admin-primary);
            margin-bottom: 10px;
        }
        
        .auth-logo p {
            color: #666;
        }
        
        .auth-form {
            margin-top: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: right;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--admin-text);
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--admin-border);
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: var(--admin-primary);
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
        }
        
        .auth-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--admin-primary), #311b92);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .auth-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(26, 35, 126, 0.2);
        }
        
        .auth-error {
            color: var(--admin-danger);
            margin-top: 10px;
            font-size: 0.9rem;
            display: none;
        }
        
        /* لوحة التحكم */
        .admin-container {
            display: none;
        }
        
        .admin-header {
            background: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .admin-brand {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-brand i {
            font-size: 1.5rem;
            color: var(--admin-primary);
        }
        
        .admin-brand h1 {
            font-size: 1.5rem;
            color: var(--admin-primary);
            margin-bottom: 5px;
        }
        
        .admin-brand p {
            font-size: 0.9rem;
            color: #666;
        }
        
        .admin-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .logout-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--admin-danger);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            background: #d32f2f;
            transform: translateY(-2px);
        }
        
        .admin-main {
            display: flex;
            min-height: calc(100vh - 70px);
        }
        
        .admin-sidebar {
            width: 250px;
            background: var(--admin-sidebar);
            color: white;
            padding: 30px 0;
            flex-shrink: 0;
        }
        
        .admin-menu {
            list-style: none;
        }
        
        .admin-menu li {
            margin-bottom: 5px;
        }
        
        .admin-menu a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 30px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: all 0.3s;
            border-right: 4px solid transparent;
        }
        
        .admin-menu a:hover,
        .admin-menu a.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-right-color: var(--admin-success);
        }
        
        .admin-menu a i {
            font-size: 1.1rem;
            width: 24px;
        }
        
        .admin-content {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
        }
        
        .content-header {
            margin-bottom: 30px;
        }
        
        .content-header h2 {
            color: var(--admin-primary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-top: 4px solid var(--admin-primary);
        }
        
        .stat-card h3 {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--admin-primary);
        }
        
        .stat-card .change {
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .stat-card .change.positive {
            color: var(--admin-success);
        }
        
        .stat-card .change.negative {
            color: var(--admin-danger);
        }
        
        /* قسم المنتجات */
        .products-section {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .section-header h3 {
            color: var(--admin-primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-add {
            padding: 10px 20px;
            background: var(--admin-success);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-add:hover {
            background: #388e3c;
            transform: translateY(-2px);
        }
        
        .btn-export {
            padding: 10px 20px;
            background: var(--admin-primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-export:hover {
            background: #311b92;
            transform: translateY(-2px);
        }
        
        .products-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .products-table th {
            background: var(--admin-bg);
            padding: 15px;
            text-align: right;
            font-weight: 600;
            color: var(--admin-text);
            border-bottom: 2px solid var(--admin-border);
        }
        
        .products-table td {
            padding: 15px;
            border-bottom: 1px solid var(--admin-border);
        }
        
        .product-image {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }
        
        .product-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-edit, .btn-delete {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-family: 'Cairo', sans-serif;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-edit {
            background: var(--admin-primary);
            color: white;
        }
        
        .btn-edit:hover {
            background: #311b92;
        }
        
        .btn-delete {
            background: var(--admin-danger);
            color: white;
        }
        
        .btn-delete:hover {
            background: #d32f2f;
        }
        
        /* نموذج إضافة منتج */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 15px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease;
        }
        
        @keyframes modalSlide {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-header {
            padding: 20px 30px;
            border-bottom: 1px solid var(--admin-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            color: var(--admin-primary);
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            padding: 5px;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--admin-text);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--admin-border);
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--admin-primary);
            box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--admin-border);
        }
        
        .btn-save, .btn-cancel {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-family: 'Cairo', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            flex: 1;
        }
        
        .btn-save {
            background: var(--admin-success);
            color: white;
        }
        
        .btn-save:hover {
            background: #388e3c;
            transform: translateY(-2px);
        }
        
        .btn-cancel {
            background: var(--admin-border);
            color: var(--admin-text);
        }
        
        .btn-cancel:hover {
            background: #d0d5dd;
        }
        
        /* تنبيهات */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .alert.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        /* تحميل */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loading i {
            font-size: 2rem;
            color: var(--admin-primary);
            margin-bottom: 15px;
        }
        
        /* تجاوبية */
        @media (max-width: 992px) {
            .admin-main {
                flex-direction: column;
            }
            
            .admin-sidebar {
                width: 100%;
                padding: 15px 0;
            }
            
            .admin-menu {
                display: flex;
                overflow-x: auto;
                padding: 0 15px;
            }
            
            .admin-menu li {
                margin-bottom: 0;
                flex-shrink: 0;
            }
            
            .admin-menu a {
                padding: 10px 15px;
                border-right: none;
                border-bottom: 4px solid transparent;
            }
            
            .admin-menu a:hover,
            .admin-menu a.active {
                border-right-color: transparent;
                border-bottom-color: var(--admin-success);
            }
        }
        
        @media (max-width: 768px) {
            .admin-header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }
            
            .admin-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .form-row {
                flex-direction: column;
                gap: 15px;
            }
            
            .products-table {
                display: block;
                overflow-x: auto;
            }
            
            .modal-content {
                margin: 20px;
            }
        }
        
        @media (max-width: 576px) {
            .auth-box {
                padding: 30px 20px;
            }
            
            .admin-content {
                padding: 20px;
            }
            
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .section-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .section-actions {
                width: 100%;
            }
            
            .btn-add, .btn-export {
                flex: 1;
            }
            
            .form-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- شاشة المصادقة -->
    <div class="auth-container" id="authContainer">
        <div class="auth-box">
            <div class="auth-logo">
                <i class="fas fa-microchip"></i>
                <h1>نبض التقنية</h1>
                <p>لوحة تحكم المدير</p>
            </div>
            
            <form class="auth-form" id="loginForm">
                <div class="form-group">
                    <label for="username"><i class="fas fa-user"></i> اسم المستخدم</label>
                    <input type="text" id="username" name="username" required placeholder="أدخل اسم المستخدم">
                </div>
                
                <div class="form-group">
                    <label for="password"><i class="fas fa-lock"></i> كلمة المرور</label>
                    <input type="password" id="password" name="password" required placeholder="أدخل كلمة المرور">
                </div>
                
                <div class="auth-error" id="authError">
                    <i class="fas fa-exclamation-circle"></i> اسم المستخدم أو كلمة المرور غير صحيحة
                </div>
                
                <button type="submit" class="auth-btn">
                    <i class="fas fa-sign-in-alt"></i> دخول
                </button>
            </form>
        </div>
    </div>
    
    <!-- لوحة التحكم -->
    <div class="admin-container" id="adminContainer">
        <!-- الهيدر -->
        <header class="admin-header">
            <div class="admin-brand">
                <i class="fas fa-cog"></i>
                <div>
                    <h1>لوحة التحكم</h1>
                    <p>إدارة متجر نبض التقنية</p>
                </div>
            </div>
            
            <div class="admin-actions">
                <div class="admin-user">
                    <i class="fas fa-user-circle"></i>
                    <span id="adminUsername">المدير</span>
                </div>
                <button class="logout-btn" id="logoutBtn">
                    <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                </button>
            </div>
        </header>
        
        <!-- المحتوى الرئيسي -->
        <div class="admin-main">
            <!-- الشريط الجانبي -->
            <nav class="admin-sidebar">
                <ul class="admin-menu">
                    <li><a href="#dashboard" class="active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i> لوحة التحكم
                    </a></li>
                    <li><a href="#products" data-section="products">
                        <i class="fas fa-box"></i> المنتجات
                    </a></li>
                    <li><a href="#orders" data-section="orders">
                        <i class="fas fa-shopping-cart"></i> الطلبات
                    </a></li>
                    <li><a href="#customers" data-section="customers">
                        <i class="fas fa-users"></i> العملاء
                    </a></li>
                    <li><a href="#settings" data-section="settings">
                        <i class="fas fa-cogs"></i> الإعدادات
                    </a></li>
                    <li><a href="../index.html" target="_blank">
                        <i class="fas fa-external-link-alt"></i> زيارة المتجر
                    </a></li>
                </ul>
            </nav>
            
            <!-- المحتوى -->
            <div class="admin-content">
                <!-- التنبيهات -->
                <div class="alert success" id="successAlert">
                    تم حفظ التغييرات بنجاح
                </div>
                
                <div class="alert error" id="errorAlert">
                    حدث خطأ أثناء حفظ التغييرات
                </div>
                
                <!-- التحميل -->
                <div class="loading" id="loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>جاري التحميل...</p>
                </div>
                
                <!-- الأقسام -->
                <div class="content-section" id="dashboardSection">
                    <div class="content-header">
                        <h2><i class="fas fa-tachometer-alt"></i> لوحة التحكم</h2>
                        <p>نظرة عامة على أداء المتجر</p>
                    </div>
                    
                    <div class="stats-cards">
                        <div class="stat-card">
                            <h3><i class="fas fa-box"></i> إجمالي المنتجات</h3>
                            <div class="value" id="totalProducts">0</div>
                            <div class="change positive" id="productsChange">
                                <i class="fas fa-arrow-up"></i> 5 منتجات هذا الشهر
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-shopping-cart"></i> إجمالي الطلبات</h3>
                            <div class="value" id="totalOrders">0</div>
                            <div class="change positive" id="ordersChange">
                                <i class="fas fa-arrow-up"></i> 12 طلب هذا الشهر
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-money-bill-wave"></i> إجمالي الإيرادات</h3>
                            <div class="value" id="totalRevenue">0 ر.س</div>
                            <div class="change positive" id="revenueChange">
                                <i class="fas fa-arrow-up"></i> 15% زيادة
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-users"></i> إجمالي العملاء</h3>
                            <div class="value" id="totalCustomers">0</div>
                            <div class="change positive" id="customersChange">
                                <i class="fas fa-arrow-up"></i> 8 عملاء جدد
                            </div>
                        </div>
                    </div>
                    
                    <div class="products-section">
                        <div class="section-header">
                            <h3><i class="fas fa-chart-line"></i> آخر المنتجات</h3>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="products-table" id="recentProductsTable">
                                <thead>
                                    <tr>
                                        <th>الصورة</th>
                                        <th>المنتج</th>
                                        <th>السعر</th>
                                        <th>الفئة</th>
                                        <th>المخزون</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="recentProductsBody">
                                    <!-- المنتجات تظهر هنا -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- قسم المنتجات -->
                <div class="content-section" id="productsSection" style="display: none;">
                    <div class="content-header">
                        <h2><i class="fas fa-box"></i> إدارة المنتجات</h2>
                        <p>إضافة وتعديل وحذف المنتجات</p>
                    </div>
                    
                    <div class="products-section">
                        <div class="section-header">
                            <h3><i class="fas fa-list"></i> جميع المنتجات</h3>
                            <div class="section-actions">
                                <button class="btn-export" id="exportBtn">
                                    <i class="fas fa-download"></i> تصدير
                                </button>
                                <button class="btn-add" id="addProductBtn">
                                    <i class="fas fa-plus"></i> إضافة منتج جديد
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="products-table" id="allProductsTable">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>الصورة</th>
                                        <th>المنتج</th>
                                        <th>السعر</th>
                                        <th>الفئة</th>
                                        <th>المخزون</th>
                                        <th>الحالة</th>
                                        <th>الإجراءات</th>
                                    </tr>
                                </thead>
                                <tbody id="allProductsBody">
                                    <!-- جميع المنتجات تظهر هنا -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- قسم الطلبات -->
                <div class="content-section" id="ordersSection" style="display: none;">
                    <div class="content-header">
                        <h2><i class="fas fa-shopping-cart"></i> إدارة الطلبات</h2>
                        <p>متابعة وتحديث حالة الطلبات</p>
                    </div>
                    
                    <div class="products-section">
                        <div class="section-header">
                            <h3><i class="fas fa-clipboard-list"></i> الطلبات الحديثة</h3>
                        </div>
                        
                        <div class="orders-container" id="ordersContainer">
                            <p>لم يتم تنفيذ هذا القسم بعد. يمكنك إضافة النظام لاحقاً.</p>
                        </div>
                    </div>
                </div>
                
                <!-- قسم العملاء -->
                <div class="content-section" id="customersSection" style="display: none;">
                    <div class="content-header">
                        <h2><i class="fas fa-users"></i> إدارة العملاء</h2>
                        <p>عرض وتتبع بيانات العملاء</p>
                    </div>
                    
                    <div class="products-section">
                        <div class="section-header">
                            <h3><i class="fas fa-user-friends"></i> قاعدة بيانات العملاء</h3>
                        </div>
                        
                        <div class="customers-container" id="customersContainer">
                            <p>لم يتم تنفيذ هذا القسم بعد. يمكنك إضافة النظام لاحقاً.</p>
                        </div>
                    </div>
                </div>
                
                <!-- قسم الإعدادات -->
                <div class="content-section" id="settingsSection" style="display: none;">
                    <div class="content-header">
                        <h2><i class="fas fa-cogs"></i> إعدادات المتجر</h2>
                        <p>تعديل إعدادات المتجر العامة</p>
                    </div>
                    
                    <div class="products-section">
                        <form id="settingsForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="storeName">اسم المتجر</label>
                                    <input type="text" id="storeName" value="نبض التقنية" required>
                                </div>
                                <div class="form-group">
                                    <label for="storePhone">رقم الهاتف</label>
                                    <input type="tel" id="storePhone" value="+966501234567" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="storeWhatsApp">رقم الواتساب</label>
                                    <input type="tel" id="storeWhatsApp" value="966501234567" required>
                                </div>
                                <div class="form-group">
                                    <label for="storeEmail">البريد الإلكتروني</label>
                                    <input type="email" id="storeEmail" value="info@nabd-alteqnia.com">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="storeLocation">الموقع</label>
                                    <input type="text" id="storeLocation" value="المملكة العربية السعودية" required>
                                </div>
                                <div class="form-group">
                                    <label for="storeHours">ساعات العمل</label>
                                    <input type="text" id="storeHours" value="9:00 ص - 12:00 م" required>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn-save">
                                    <i class="fas fa-save"></i> حفظ التغييرات
                                </button>
                                <button type="button" class="btn-cancel" onclick="AdminUI.resetSettings()">
                                    <i class="fas fa-undo"></i> إعادة تعيين
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- نموذج إضافة/تعديل منتج -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">إضافة منتج جديد</h3>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <form id="productForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productId">رقم المنتج</label>
                            <input type="number" id="productId" required min="1">
                        </div>
                        <div class="form-group">
                            <label for="productName">اسم المنتج</label>
                            <input type="text" id="productName" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productPrice">السعر (ريال)</label>
                            <input type="number" id="productPrice" required min="0" step="0.01">
                        </div>
                        <div class="form-group">
                            <label for="productOriginalPrice">السعر الأصلي (اختياري)</label>
                            <input type="number" id="productOriginalPrice" min="0" step="0.01">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productCategory">الفئة</label>
                            <select id="productCategory" required>
                                <option value="">اختر الفئة</option>
                                <option value="electronics">إلكترونيات</option>
                                <option value="hardware">خردوات</option>
                                <option value="accessories">ملحقات</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="productStock">المخزون</label>
                            <input type="number" id="productStock" required min="0" value="0">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productImage">رابط الصورة</label>
                            <input type="url" id="productImage" required 
                                   placeholder="https://example.com/image.jpg">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productDescription">الوصف المختصر</label>
                            <textarea id="productDescription" required></textarea>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productFullDescription">الوصف الكامل</label>
                            <textarea id="productFullDescription"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="productTags">العلامات (مفصولة بفواصل)</label>
                            <input type="text" id="productTags" 
                                   placeholder="جديد, عرض خاص, الأكثر مبيعاً">
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-save" id="saveProductBtn">
                            <i class="fas fa-save"></i> حفظ المنتج
                        </button>
                        <button type="button" class="btn-cancel" id="cancelProductBtn">
                            <i class="fas fa-times"></i> إلغاء
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- السكريبتات -->
    <script>
        // نظام لوحة التحكم
        const AdminSystem = {
            currentUser: null,
            products: [],
            isEditing: false,
            currentProductId: null,
            
            // بيانات الاعتماد (يمكن تغييرها)
            credentials: {
                username: "admin",
                password: "nabd123"
            },
            
            // تهيئة النظام
            init: function() {
                this.initAuth();
                this.initUI();
                this.loadProducts();
            },
            
            // نظام المصادقة
            initAuth: function() {
                // التحقق من تسجيل الدخول السابق
                const savedUser = localStorage.getItem('nabdAdminUser');
                if (savedUser) {
                    try {
                        this.currentUser = JSON.parse(savedUser);
                        this.showAdminPanel();
                    } catch (e) {
                        localStorage.removeItem('nabdAdminUser');
                    }
                }
                
                // إعداد نموذج الدخول
                const loginForm = document.getElementById('loginForm');
                if (loginForm) {
                    loginForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.login();
                    });
                }
                
                // زر تسجيل الخروج
                const logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', () => this.logout());
                }
            },
            
            // الدخول
            login: function() {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const authError = document.getElementById('authError');
                
                if (username === this.credentials.username && 
                    password === this.credentials.password) {
                    
                    this.currentUser = {
                        username: username,
                        loginTime: new Date().toISOString()
                    };
                    
                    // حفظ بيانات الدخول
                    localStorage.setItem('nabdAdminUser', JSON.stringify(this.currentUser));
                    localStorage.setItem('nabdAdminLoggedIn', 'true');
                    
                    // عرض لوحة التحكم
                    this.showAdminPanel();
                    
                    // مسح النموذج
                    document.getElementById('loginForm').reset();
                    authError.style.display = 'none';
                    
                } else {
                    authError.style.display = 'block';
                }
            },
            
            // تسجيل الخروج
            logout: function() {
                if (confirm('هل أنت متأكد من تسجيل الخروج؟')) {
                    localStorage.removeItem('nabdAdminUser');
                    localStorage.removeItem('nabdAdminLoggedIn');
                    this.currentUser = null;
                    this.showLoginPanel();
                }
            },
            
            // عرض لوحة التحكم
            showAdminPanel: function() {
                document.getElementById('authContainer').style.display = 'none';
                document.getElementById('adminContainer').style.display = 'block';
                
                // تحديث اسم المستخدم
                if (this.currentUser) {
                    document.getElementById('adminUsername').textContent = this.currentUser.username;
                }
            },
            
            // عرض شاشة الدخول
            showLoginPanel: function() {
                document.getElementById('authContainer').style.display = 'flex';
                document.getElementById('adminContainer').style.display = 'none';
            },
            
            // واجهة المستخدم
            initUI: function() {
                // القائمة الجانبية
                document.querySelectorAll('.admin-menu a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        
                        // تحديث القائمة النشطة
                        document.querySelectorAll('.admin-menu a').forEach(l => {
                            l.classList.remove('active');
                        });
                        link.classList.add('active');
                        
                        // عرض القسم المحدد
                        const section = link.dataset.section;
                        this.showSection(section);
                    });
                });
                
                // زر إضافة منتج
                document.getElementById('addProductBtn')?.addEventListener('click', () => {
                    this.openProductModal();
                });
                
                // زر التصدير
                document.getElementById('exportBtn')?.addEventListener('click', () => {
                    this.exportProducts();
                });
                
                // نموذج المنتج
                const productForm = document.getElementById('productForm');
                if (productForm) {
                    productForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.saveProduct();
                    });
                }
                
                // إغلاق النموذج
                document.getElementById('modalClose')?.addEventListener('click', () => {
                    this.closeProductModal();
                });
                
                document.getElementById('cancelProductBtn')?.addEventListener('click', () => {
                    this.closeProductModal();
                });
                
                // إغلاق النموذج عند النقر خارج المحتوى
                document.getElementById('productModal')?.addEventListener('click', (e) => {
                    if (e.target.id === 'productModal') {
                        this.closeProductModal();
                    }
                });
                
                // النموذج إعدادات
                const settingsForm = document.getElementById('settingsForm');
                if (settingsForm) {
                    settingsForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.saveSettings();
                    });
                }
                
                // تحميل الإعدادات
                this.loadSettings();
            },
            
            // عرض الأقسام
            showSection: function(sectionId) {
                // إخفاء جميع الأقسام
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'none';
                });
                
                // عرض القسم المحدد
                const targetSection = document.getElementById(sectionId + 'Section');
                if (targetSection) {
                    targetSection.style.display = 'block';
                    
                    // تحديث البيانات حسب القسم
                    switch(sectionId) {
                        case 'dashboard':
                            this.updateDashboard();
                            break;
                        case 'products':
                            this.displayAllProducts();
                            break;
                    }
                }
            },
            
            // تحميل المنتجات
            loadProducts: async function() {
                try {
                    const response = await fetch('../data/products.json');
                    const data = await response.json();
                    this.products = data.products || [];
                    
                    // تحديث لوحة التحكم
                    this.updateDashboard();
                    this.displayAllProducts();
                    this.displayRecentProducts();
                    
                } catch (error) {
                    console.error('خطأ في تحميل المنتجات:', error);
                    this.showError('حدث خطأ في تحميل المنتجات');
                }
            },
            
            // تحديث لوحة التحكم
            updateDashboard: function() {
                if (!this.products.length) return;
                
                // الإحصائيات
                document.getElementById('totalProducts').textContent = this.products.length;
                document.getElementById('totalOrders').textContent = '127';
                document.getElementById('totalRevenue').textContent = '85,430 ر.س';
                document.getElementById('totalCustomers').textContent = '89';
                
                // عرض أحدث المنتجات
                this.displayRecentProducts();
            },
            
            // عرض أحدث المنتجات
            displayRecentProducts: function() {
                const tbody = document.getElementById('recentProductsBody');
                if (!tbody) return;
                
                // أخذ أحدث 5 منتجات
                const recentProducts = [...this.products]
                    .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                    .slice(0, 5);
                
                let html = '';
                recentProducts.forEach(product => {
                    html += `
                        <tr>
                            <td>
                                <img src="${product.image}" 
                                     alt="${product.name}" 
                                     class="product-image"
                                     onerror="this.src='https://via.placeholder.com/50/1a237e/ffffff?text=نبض'">
                            </td>
                            <td>${product.name}</td>
                            <td>${product.price} ر.س</td>
                            <td>${this.getCategoryName(product.category)}</td>
                            <td>${product.stock}</td>
                            <td>
                                <div class="product-actions">
                                    <button class="btn-edit" onclick="AdminSystem.editProduct(${product.id})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-delete" onclick="AdminSystem.deleteProduct(${product.id})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tbody.innerHTML = html;
            },
            
            // عرض جميع المنتجات
            displayAllProducts: function() {
                const tbody = document.getElementById('allProductsBody');
                if (!tbody) return;
                
                let html = '';
                this.products.forEach((product, index) => {
                    html += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>
                                <img src="${product.image}" 
                                     alt="${product.name}" 
                                     class="product-image"
                                     onerror="this.src='https://via.placeholder.com/50/1a237e/ffffff?text=نبض'">
                            </td>
                            <td>${product.name}</td>
                            <td>${product.price} ر.س</td>
                            <td>${this.getCategoryName(product.category)}</td>
                            <td>${product.stock}</td>
                            <td>
                                <span class="status ${product.stock > 0 ? 'in-stock' : 'out-of-stock'}">
                                    ${product.stock > 0 ? 'متوفر' : 'نفذ'}
                                </span>
                            </td>
                            <td>
                                <div class="product-actions">
                                    <button class="btn-edit" onclick="AdminSystem.editProduct(${product.id})">
                                        <i class="fas fa-edit"></i> تعديل
                                    </button>
                                    <button class="btn-delete" onclick="AdminSystem.deleteProduct(${product.id})">
                                        <i class="fas fa-trash"></i> حذف
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                });
                
                tbody.innerHTML = html;
            },
            
            // اسم الفئة
            getCategoryName: function(categoryId) {
                const categories = {
                    'electronics': 'إلكترونيات',
                    'hardware': 'خردوات',
                    'accessories': 'ملحقات',
                    'new': 'جديد'
                };
                return categories[categoryId] || categoryId;
            },
            
            // فتح نموذج المنتج
            openProductModal: function(productId = null) {
                const modal = document.getElementById('productModal');
                const title = document.getElementById('modalTitle');
                const form = document.getElementById('productForm');
                
                if (productId) {
                    // وضع التعديل
                    this.isEditing = true;
                    this.currentProductId = productId;
                    title.textContent = 'تعديل المنتج';
                    
                    // تعبئة البيانات
                    const product = this.products.find(p => p.id == productId);
                    if (product) {
                        document.getElementById('productId').value = product.id;
                        document.getElementById('productName').value = product.name;
                        document.getElementById('productPrice').value = product.price;
                        document.getElementById('productOriginalPrice').value = product.originalPrice || '';
                        document.getElementById('productCategory').value = product.category;
                        document.getElementById('productStock').value = product.stock || 0;
                        document.getElementById('productImage').value = product.image;
                        document.getElementById('productDescription').value = product.description;
                        document.getElementById('productFullDescription').value = product.fullDescription || '';
                        document.getElementById('productTags').value = product.tags ? product.tags.join(', ') : '';
                    }
                    
                } else {
                    // وضع الإضافة
                    this.isEditing = false;
                    this.currentProductId = null;
                    title.textContent = 'إضافة منتج جديد';
                    
                    // تفريغ النموذج
                    form.reset();
                    
                    // توليد ID جديد
                    const newId = this.products.length > 0 ? 
                        Math.max(...this.products.map(p => p.id)) + 1 : 100;
                    document.getElementById('productId').value = newId;
                }
                
                // عرض النموذج
                modal.style.display = 'flex';
            },
            
            // إغلاق نموذج المنتج
            closeProductModal: function() {
                document.getElementById('productModal').style.display = 'none';
                document.getElementById('productForm').reset();
                this.isEditing = false;
                this.currentProductId = null;
            },
            
            // حفظ المنتج
            saveProduct: async function() {
                const form = document.getElementById('productForm');
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }
                
                const product = {
                    id: parseInt(document.getElementById('productId').value),
                    name: document.getElementById('productName').value,
                    price: parseFloat(document.getElementById('productPrice').value),
                    originalPrice: document.getElementById('productOriginalPrice').value ? 
                        parseFloat(document.getElementById('productOriginalPrice').value) : null,
                    category: document.getElementById('productCategory').value,
                    stock: parseInt(document.getElementById('productStock').value),
                    image: document.getElementById('productImage').value,
                    description: document.getElementById('productDescription').value,
                    fullDescription: document.getElementById('productFullDescription').value || '',
                    tags: document.getElementById('productTags').value ? 
                        document.getElementById('productTags').value.split(',').map(t => t.trim()) : [],
                    supplier: {
                        name: "المورد",
                        phone: "0500000000",
                        location: "الرياض"
                    },
                    features: ["جودة عالية", "ضمان", "توصيل سريع"],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                try {
                    if (this.isEditing) {
                        // تحديث المنتج
                        const index = this.products.findIndex(p => p.id == this.currentProductId);
                        if (index !== -1) {
                            this.products[index] = product;
                            this.showSuccess('تم تحديث المنتج بنجاح');
                        }
                    } else {
                        // إضافة منتج جديد
                        this.products.push(product);
                        this.showSuccess('تم إضافة المنتج بنجاح');
                    }
                    
                    // حفظ البيانات
                    await this.saveProductsToFile();
                    
                    // تحديث العرض
                    this.displayAllProducts();
                    this.displayRecentProducts();
                    this.updateDashboard();
                    
                    // إغلاق النموذج
                    this.closeProductModal();
                    
                } catch (error) {
                    console.error('خطأ في حفظ المنتج:', error);
                    this.showError('حدث خطأ في حفظ المنتج');
                }
            },
            
            // تعديل المنتج
            editProduct: function(productId) {
                this.openProductModal(productId);
            },
            
            // حذف المنتج
            deleteProduct: function(productId) {
                if (confirm('هل أنت متأكد من حذف هذا المنتج؟')) {
                    const index = this.products.findIndex(p => p.id == productId);
                    if (index !== -1) {
                        this.products.splice(index, 1);
                        this.saveProductsToFile().then(() => {
                            this.displayAllProducts();
                            this.displayRecentProducts();
                            this.updateDashboard();
                            this.showSuccess('تم حذف المنتج بنجاح');
                        }).catch(error => {
                            console.error('خطأ في حذف المنتج:', error);
                            this.showError('حدث خطأ في حذف المنتج');
                        });
                    }
                }
            },
            
            // حفظ المنتجات للملف
            saveProductsToFile: async function() {
                try {
                    // في بيئة حقيقية، هنا يتم إرسال البيانات للخادم
                    // لكن في هذا الإصدار، نستخدم localStorage للتخزين المؤقت
                    const data = {
                        products: this.products,
                        lastUpdated: new Date().toISOString()
                    };
                    
                    localStorage.setItem('nabdProducts', JSON.stringify(data));
                    return Promise.resolve();
                    
                } catch (error) {
                    return Promise.reject(error);
                }
            },
            
            // تصدير المنتجات
            exportProducts: function() {
                const dataStr = JSON.stringify(this.products, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
                
                const exportFileDefaultName = `nabd-products-${new Date().toISOString().split('T')[0]}.json`;
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                this.showSuccess('تم تصدير المنتجات بنجاح');
            },
            
            // تحميل الإعدادات
            loadSettings: function() {
                const settings = JSON.parse(localStorage.getItem('nabdSettings') || '{}');
                
                if (settings.storeName) {
                    document.getElementById('storeName').value = settings.storeName;
                }
                if (settings.storePhone) {
                    document.getElementById('storePhone').value = settings.storePhone;
                }
                if (settings.storeWhatsApp) {
                    document.getElementById('storeWhatsApp').value = settings.storeWhatsApp;
                }
                if (settings.storeEmail) {
                    document.getElementById('storeEmail').value = settings.storeEmail;
                }
                if (settings.storeLocation) {
                    document.getElementById('storeLocation').value = settings.storeLocation;
                }
                if (settings.storeHours) {
                    document.getElementById('storeHours').value = settings.storeHours;
                }
            },
            
            // حفظ الإعدادات
            saveSettings: function() {
                const settings = {
                    storeName: document.getElementById('storeName').value,
                    storePhone: document.getElementById('storePhone').value,
                    storeWhatsApp: document.getElementById('storeWhatsApp').value,
                    storeEmail: document.getElementById('storeEmail').value,
                    storeLocation: document.getElementById('storeLocation').value,
                    storeHours: document.getElementById('storeHours').value,
                    updatedAt: new Date().toISOString()
                };
                
                localStorage.setItem('nabdSettings', JSON.stringify(settings));
                this.showSuccess('تم حفظ الإعدادات بنجاح');
            },
            
            // عرض رسالة نجاح
            showSuccess: function(message) {
                const alert = document.getElementById('successAlert');
                alert.textContent = message;
                alert.style.display = 'block';
                
                setTimeout(() => {
                    alert.style.display = 'none';
                }, 3000);
            },
            
            // عرض رسالة خطأ
            showError: function(message) {
                const alert = document.getElementById('errorAlert');
                alert.textContent = message;
                alert.style.display = 'block';
                
                setTimeout(() => {
                    alert.style.display = 'none';
                }, 3000);
            },
            
            // إعادة تعيين الإعدادات
            resetSettings: function() {
                if (confirm('هل تريد إعادة تعيين الإعدادات إلى القيم الافتراضية؟')) {
                    const defaultSettings = {
                        storeName: "نبض التقنية",
                        storePhone: "+967770241960",
                        storeWhatsApp: "967778122378",
                        storeEmail: "info@nabd-alteqnia.com",
                        storeLocation: " اليمن - الضالع - مريس",
                        storeHours: "9:00 ص - 12:00 م"
                    };
                    
                    Object.keys(defaultSettings).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) element.value = defaultSettings[key];
                    });
                    
                    this.showSuccess('تم إعادة تعيين الإعدادات');
                }
            }
        };
        
        // واجهة المستخدم المساعدة
        const AdminUI = {
            resetSettings: function() {
                AdminSystem.resetSettings();
            }
        };
        
        // تهيئة النظام عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', () => {
            AdminSystem.init();
        });
    </script>
</body>
</html>